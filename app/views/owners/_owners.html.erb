<h4 class="font-weight-bold text-primary text-center mb-2"><%= t("owners") %></h4>
<hr>
<div class="container d-flex justify-content-center mt-5">
  <%= form_with url: filter_owners_path, method: :get, data: { turbo_frame: "owners"}, class: "row g-3" do |form| %>
    <div class="col-auto">
      <%= form.select :language,
            options_for_select(
            [[t("ca"),'ca'],[t("en"),'en'],[t("es"),'es'],[t("fr"),'fr']],
            ),
            { include_blank: 'tots els idiomes' },
            class: "form-select"
          %>
    </div>
    <div class="col-auto">
      <%= form.text_field :fullname,
          placeholder: "Buscar per nom",
          class: "form-control bg-white border-0 small",
          autocomplete: "off" %>
    </div>
    <div class="col-auto">
      <%= form.button class: "btn btn-primary me-3" do %>
        <i class="fas fa-search fa-sm"></i>
      <% end %>
    </div>
    <div class="col-auto">
      <%= link_to "Veure tots els propietaris", owners_path, class: "btn btn-secondary" %>
    </div>
    <div class="col-auto">
      <%= link_to new_owner_path, class: "btn btn-light btn-icon-split" do %>
        <span class="icon text-white-600">
          <i class="fas fa-plus"></i>
        </span>
        <span class="text">
          Afegir propietari nou
        </span>
      <% end %>
    </div>
  <% end %>
</div>
<%= turbo_frame_tag "owners", class: "card-body" do %>
  <div class="container-fluid my-3">
    <div>
      <div class="row border border-top border-bottom fw-bold bg-light">
        <div class="col col-lg-3 py-3 nowrap" id="owner-fullname" relative>
          Nom i cognoms
        </div>
        <div class="col-lg-1 py-3" id="owner-language" relative>
          Idioma
        </div>
        <div class="col-lg-2 py-3" id="owner-phone" relative>
          Tel√®fon
        </div>
        <div class="col-lg-3 py-3" id="owner-email" relative>
          Email
        </div>
        <div class="col-lg-2 py-3" id="owner-vrentals" relative>
          Immobles
        </div>
        <div class="col-lg-1 py-3">
        </div>
      </div>
    </div>
    <div class="tbody">
      <% @owners.each do |owner| %>
        <div class="row border">
          <div class="col-lg-3 align-self-center nowrap"><%= link_to owner.fullname, owner %></div>
          <div class="col-lg-1 align-self-center"><%= owner.language if owner.language %></div>
          <div class="col-lg-2 align-self-center"><%= owner.phone %></div>
          <div class="col-lg-3 align-self-center nowrap"><%= owner.email %></div>
          <div class="col-lg-2 align-self-center"><%= owner.vrentals.map {|vrental| vrental.name}.to_sentence  %></div>
          <div class="col-lg-1 align-self-center nowrap d-flex justify-content-between">
            <%= link_to edit_owner_path(owner), class: "text-info text-decoration-none" do %>
              <i class="fas fa-edit fa-sm"></i>
            <% end %>
            <%= link_to owner, data: {turbo_method: :delete, turbo_confirm: "Segur que vols esborrar #{owner.fullname}?"}, class: "text-danger text-decoration-none" do %>
              <i class="fas fa-trash fa-sm"></i>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
  <div class="d-flex justify-content-center">
    <%== pagy_bootstrap_nav(@pagy) if @pagy.pages > 1 %>
  </div>
<% end %>
