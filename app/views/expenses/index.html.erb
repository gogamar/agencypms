<h4 class="font-weight-bold text-primary text-center mb-2">Despeses</h4>
<hr>
<% if @expenses.present? %>
  <h6 class="text-center">Total despeses propietari: <%= number_to_currency(@total_expenses_owner, unit: "€", separator: ",", delimiter: ".", precision: 2) %></h6>
  <h6 class="text-center">Total despeses agència: <%= number_to_currency(@total_expenses_agency, unit: "€", separator: ",", delimiter: ".", precision: 2) %></h6>
<% end %>
<div>
  <% if @vrental %>
    <%= link_to new_vrental_expense_path(@vrental), class: "btn btn-primary mb-3" do %>
      <i class="fas fa-plus fa-sm"></i>
      <span class="text">Nova despesa <%= @vrental.name %></span>
    <% end %>
  <% else %>
    <%= link_to new_expense_path, class: "btn btn-primary mb-3" do %>
      <i class="fas fa-plus fa-sm"></i>
      <span class="text">Nova despesa</span>
    <% end %>
  <% end %>
</div>
<% if @expenses.present? %>
  <hr>
  <table class="table table-hover">
    <thead>
      <tr>
        <th scope="col">Immoble</th>
        <th scope="col">Refèrencia</th>
        <th scope="col">Liquidació</th>
        <th scope="col">Tipus despesa</th>
        <th scope="col">Concepte</th>
        <th scope="col">Import</th>
        <th scope="col">Editar</th>
      </tr>
    </thead>
    <tbody>
      <% @expenses.each do |expense| %>
        <tr>
          <th scope="row"><%= link_to expense.vrental.name, vrental_expenses_path(expense.vrental) %></th>
          <td><%= expense.expense_number %></td>
          <td>
            <% if expense.statement %>
              <%= link_to "Liquidació #{l(expense.statement.date)}", vrental_statement_path(expense.vrental, expense.statement) %>
            <% end %>
          </td>
          <td><%= t("#{expense.expense_type}") %></td>
          <td><%= expense.description %></td>
          <td><%= number_to_currency(expense.amount, unit: "€", separator: ",", delimiter: ".", precision: 2) %></td>
          <td class="d-flex justify-content-between">
            <%= link_to edit_vrental_expense_path(expense.vrental, expense), class: "text-info text-decoration-none" do %>
              <i class="fas fa-pen fa-sm"></i>
            <% end %>
            <% unless expense.statement && expense.statement.invoice %>
              <%= link_to (@vrental ? vrental_expense_path(@vrental, expense) : expense), data: {turbo_method: :delete, turbo_confirm: "Segur que vols esborrar aquesta despesa?"}, class: "text-danger text-decoration-none" do %>
                <i class="fas fa-trash-can fa-sm"></i>
              <% end %>
            <% end %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
<% end %>
