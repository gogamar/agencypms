<div class="mb-5">
  <h4 class="font-weight-bold text-primary text-center mb-2"><%= @vrental.name %></h4>
  <h6 class="text-center"><%= t('property_booking_conditions') %></h6>
</div>
<%= simple_form_for @vrental do |f| %>
  <%= f.error_notification %>
  <%= f.error_notification message: f.object.errors[:base].to_sentence if f.object.errors[:base].present? %>
  <%= f.hidden_field :request_context, value: 'add_booking_conditions' %>
  <%= f.input :unit_number, input_html: { value: f.object.unit_number || 1} %>
  <%= f.input :max_guests %>
  <%= f.input :min_price %>
  <%= f.input :rental_term, collection: Vrental::RENTAL_TERMS.map { |term| [t(term), term] } %>
  <%= f.input :res_fee %>
  <%= f.input :min_stay %>
  <%= f.input :free_cancel %>
  <div data-controller="booking-conditions">
    <%= f.input :price_per, collection: Vrental::PRICE_PER.map { |interval| [t(interval), interval] }, input_html: { "data-booking-conditions-target" => "pricePer", "data-action" => "change->booking-conditions#toggleDiscountIncluded"} %>
    <%= f.label :weekly_discount %>
    <div class="input-group mb-3">
      <%= f.input_field :weekly_discount, class: 'form-control', placeholder: "Per exemple, 10 o 15", 'aria-describedby' => 'basic-addon2' %>
      <span class="input-group-text" id="basic-addon2">%</span>
    </div>
    <div class="<%= 'd-none' unless f.object.price_per == "week" %>" data-booking-conditions-target="discountIncluded">
      <%= f.input :weekly_discount_included, as: :select, collection: [[t('true'), true], [t('false'), false]], include_blank: true %>
    </div>
    <% if @vrental.vrgroup.present? %>
      <label for="availability_master"><%= t('availability_master') %></label>
      <select name="availability_master" id="availability_master" class="form-select" data-booking-conditions-target="availabilityMaster" data-action="change->booking-conditions#toggleAvailabilityMaster">
        <option value="true"><%= t('true') %></option>
        <option value="false"><%= t('false') %></option>
      </select>
      <div class="<%= 'd-none' unless f.object.availability_master_id.present? %>" data-booking-conditions-target="dependantAvailability">
        <%= f.input :availability_master_id, as: :select, collection: @vrental.vrgroup.vrentals.where(availability_master_id: nil).map { |vrental| [vrental.name, vrental.id] }, hint: t('availability_master_vrental'), include_blank: t("no_availability_master") %>
      </div>
      <label for="rate_master"><%= t('rate_master') %></label>
      <select name="rate_master" id="rate_master" class="form-select" data-booking-conditions-target="rateMaster" data-action="change->booking-conditions#toggleRateMaster">
        <option value="true"><%= t('true') %></option>
        <option value="false"><%= t('false') %></option>
      </select>
      <div class="<%= 'd-none' unless f.object.rate_master_id.present? %>" data-booking-conditions-target="dependantRate">
        <%= f.input :rate_master_id, as: :select, collection: @vrental.vrgroup.vrentals.where(rate_master_id: nil).map { |vrental| [vrental.name, vrental.id] }, hint: t('rate_master_vrental'), include_blank: t("no_rate_master"), input_html: { "data-booking-conditions-target" => "masterVrental", "data-action" => "change->booking-conditions#toggleRateOffset"} %>
        <div class="<%= 'd-none' unless f.object.rate_master_id.present? %>" data-booking-conditions-target="rateOffset">
          <%= f.input :rate_offset %>
        </div>
      </div>
    <% end %>
  </div>
  <% if user_signed_in? && current_user.admin? %>
    <div class="alert alert-warning position-relative" role="alert">
      <%= t("dont-fill") %>
    </div>
    <%= f.input :beds_prop_id %>
    <%= f.input :beds_room_id %>
    <%= f.input :prop_key %>
  <% end %>
  <div class="form-actions text-end mb-5">
    <%= f.button :submit, t('global.forms.save_and_close'), class: 'btn btn-primary text-center' %>
    <%= f.button :submit, t('global.forms.continue'), class: 'btn btn-secondary text-center' %>
  </div>
<% end %>
