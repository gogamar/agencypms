<!-- ============================ Hero Banner  Start================================== -->
<div class="home-map-banner half-map">
  <div class="fs-left-map-box">
    <div class="home-map fl-wrap">
      <div class="hm-map-container fw-map">
        <div id="map" data-controller="map" data-map-markers-value="<%= @markers.to_json %>" data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>"></div>
      </div>
    </div>
  </div>
  <div class="fs-inner-container">
    <div class="fs-content">
      <div class="row">
        <div class="col-lg-12 col-md-12">
          <div class="_mp_filter mb-3">
            <div class="_mp_filter_first">
              <div class="filter_list_item">
                <div class="selected_item_wrap">
                  <% @type_bedrooms_bathrooms.each do |key, value| %>
                    <div class="slt_single_item">
                      <%= link_to request.params.except(key.to_sym), class: "remove_pills" do %>
                        <span class="pills_tex">
                          <%= key == "type" ? t(value) : "#{value} #{t(key, count: value)}" %>
                        </span>
                        <span class="remove_cross"></span>
                      <% end %>
                    </div>
                  <% end %>
                  <% if @selected_features.present? %>
                    <% @selected_features.each do |feature_id| %>
                      <div class="slt_single_item">
                        <%= link_to request.params.merge(selected_features: @selected_features - [feature_id]), class: "remove_pills" do %>
                          <span class="pills_tex">
                            <%= t(Feature.find(feature_id).name) %>
                          </span>
                          <span class="remove_cross"></span>
                        <% end %>
                      </div>
                    <% end %>
                  <% end %>
                  <% if @selected_features.present? && @selected_features.length > 1 %>
                    <div class="slt_single_item">
                      <%= link_to list_map_path, class: "clear_pills" do %>
                        <span class="pills_clears">Esborrar filtre</span>
                      <% end %>
                    </div>
                  <% end %>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!--- All List -->
      <div class="row list-layout">
        <% @vrentals.each do |vrental| %>
          <% result = @available_vrentals.find { |hash| hash.key?(vrental.id) } %>
          <% price = result[vrental.id] if result %>
          <% rate_price = vrental.rate_price(@checkin, @checkout) %>
          <% discount = (rate_price - price) / rate_price %>
          <%= render 'shared/single_property', vrental: vrental, price: price, rate_price: rate_price, discount: discount, checkin: @checkin, checkout: @checkout, guests: @guests %>
        <% end %>
        <% if @vrentals_number > 10 %>
          <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12 text-center">
              <%== pagy_bootstrap_nav(@pagy) if @pagy.pages > 1 %>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
<div class="clearfix"></div>
<!-- ============================ Hero Banner End ================================== -->
